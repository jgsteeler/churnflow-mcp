# churn MCP v0.3.1 - Review Process Implementation Plan

## Overview
v0.3.1 introduces a comprehensive Review Process system building on the v0.3.0 MCP server foundation. This allows both CLI users and AI assistants (like GitHub Copilot) to review ambiguous or low-confidence captures before permanent placement. The system provides human oversight in AI-driven task management while maintaining workflow efficiency across multiple interfaces.

## Core Features

### 1. Universal Review Interface
- **Command**: `churn review [tracker]`
- **Functionality**: 
  - Review ALL items (not just low-confidence) with easy editing
  - Quick validation of AI routing with simple accept/modify options
  - Easy tracker switching, priority adjustment, tag management
  - Type changes (action → reference, review → action, etc.)
  - Dashboard indicator for items needing review

### 2. Two-Tier Review System
- **Auto-placed items**: Direct placement with review flag for easy validation
- **Low-confidence items**: Special `## Review Queue` section requiring decision
- **Format**: Standard entries with confidence metadata and review status
- **Lifecycle**: Items can be moved, modified, or confirmed at any time

### 3. Quick Edit Actions
- **Tracker switching**: Move item between trackers with single command
- **Priority adjustment**: Change urgency levels and dates
- **Tag management**: Add/remove keywords and context tags
- **Type conversion**: Switch between action/reference/review/someday types
- **Accept as-is**: Confirm AI placement and remove review flag

### 4. Confidence-Based Flagging
- **High confidence** (>0.8): Direct placement with light review flag
- **Medium confidence** (0.5-0.8): Direct placement with prominent review flag  
- **Low confidence** (<0.5): Queue in Review Queue section for required decision

### 5. MCP Integration
- **AI Assistant Access**: Review tools available through MCP server
- **GitHub Copilot Ready**: Copilot can help users review and manage items
- **Cross-Interface**: Review decisions sync between CLI and AI assistants

## Implementation Tasks

### Phase 1: Core Infrastructure (Days 1-2)
1. **Create Review Types & Interfaces**
   - `ReviewableItem` interface with confidence and review status
   - `ReviewAction` enum (accept, move, edit-priority, edit-tags, edit-type)
   - `ReviewManager` class for item manipulation

2. **Extend Tracker Format**
   - Add `## Review Queue` section for low-confidence items
   - Add review flags/metadata to regular sections
   - Update TrackerManager for review status tracking

3. **Update InferenceEngine**
   - Add confidence scoring to all AI responses
   - Flag items for review based on confidence
   - Generate reviewable entries with edit metadata

4. **Extend MCP Server**
   - Add review management tools to MCP server
   - Enable AI assistants to help with review workflows
   - Provide review status and batch operations

### Phase 2: CLI Implementation (Days 3-4)
1. **Universal Review Command**
   - `churn review` shows all flagged items across trackers
   - `churn review tracker-name` for specific tracker review
   - Quick-edit prompts for common changes (tracker, priority, tags, type)

2. **Dashboard Integration**
   - Review indicator in status commands
   - Count of items needing review
   - Quick access to review workflow

3. **Edit Interface**
   - Simple tracker movement between any trackers
   - Priority/urgency adjustment with date changes
   - Tag addition/removal with autocomplete
   - Type conversion with proper section movement

### Phase 3: Integration & Testing (Days 5-6)
1. **TrackerManager Integration**
   - Review queue parsing and management
   - Proper section ordering with reviews
   - Cleanup of processed review items

2. **End-to-End Testing**
   - Review workflow test scenarios
   - Confidence threshold validation
   - CLI interaction testing

3. **Documentation Updates**
   - Usage examples and workflows
   - Configuration options
   - Troubleshooting guide

## Technical Specifications

### Reviewable Item Structure
```typescript
interface ReviewableItem {
  id: string;
  content: string;
  confidence: number;
  currentSection: string;
  currentTracker: string;
  timestamp: Date;
  source: 'capture' | 'inference';
  reviewStatus: 'pending' | 'flagged' | 'confirmed';
  metadata: {
    keywords: string[];
    urgency: 'high' | 'medium' | 'low';
    type: 'action' | 'reference' | 'review' | 'someday';
    editableFields: string[]; // which fields can be easily changed
  };
}
```

### Tracker Review Section Format
```markdown
## Review Queue

### 2024-01-15T10:30:00Z | confidence: 0.6 | section: Action Items
- [ ] Implement user authentication system
  - Keywords: auth, security, backend
  - Source: voice capture
  - ID: rev_abc123
```

### CLI Commands
- `churn review` - Review all flagged items across trackers
- `churn review tracker-name` - Review items in specific tracker
- `churn status` - Shows review indicator and counts
- `churn move item-id tracker-name` - Quick tracker switching
- `churn priority item-id high|medium|low` - Priority adjustment
- `churn tags item-id +tag1 -tag2` - Tag management

### MCP Server Tools
- `review_status` - Get review queue status and counts
- `review_items` - List items needing review with options to act
- `process_review` - Accept, modify, or reject review items
- `batch_review` - Process multiple review items at once

## Configuration Options

### New Config Properties
```json
{
  "review": {
    "autoReviewThreshold": 0.8,
    "requireReviewThreshold": 0.5,
    "defaultBatchSize": 10,
    "colorOutput": true,
    "showConfidenceScores": true
  }
}
```

## Success Metrics
1. **Follow-up Assurance**: 100% of captured items get human attention before action
2. **Easy Corrections**: Users can quickly fix AI routing/classification mistakes
3. **Workflow Integration**: Review process feels natural and non-disruptive
4. **ADHD-Friendly**: Clear indicators, minimal cognitive load, quick actions
5. **Pragmatic Routing**: Focus on "good enough" placement with easy correction

## Future Enhancements (v0.3.2+)
- Batch operations (accept all, reject all)
- Machine learning from review decisions
- Integration with calendar/scheduling for review sessions
- Mobile-friendly review interface

## Dependencies
- inquirer.js for interactive CLI prompts
- chalk for color output
- Enhanced confidence scoring in AI inference
- Extended TrackerManager section handling
- v0.3.0 MCP server foundation
- @modelcontextprotocol/sdk for AI assistant integration

## Risk Mitigation
- **Complexity creep**: Focus on core review workflow first
- **Performance**: Efficient parsing for large review queues
- **UX confusion**: Clear documentation and examples
- **Integration issues**: Thorough testing with existing workflows

---

*This plan builds on the formatting foundations of v0.2.2 and the MCP server capabilities of v0.3.0, creating a comprehensive review system accessible to both CLI users and AI assistants.*
